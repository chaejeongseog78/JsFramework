<!-- include libraries(jQuery, bootstrap) -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" rel="stylesheet">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>


<!-- http://www.easyjstree.com/Demos 참조 -->
<link href="/css/vendor/easytreeSkin_lion/ui.easytree.css" rel="stylesheet" class="skins" type="text/css">
<!--[if lt IE 8]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/json2/20121008/json2.js"></script>
<![endif]-->

<!-- [s] Article -->


<div id="demo_orderlist1" style="margin-top:5px">
</div>


<script type="text/javascript">
function stateChanged(nodes,uid) {

	window.activeId = '#'+uid;
	trace(window.activeId);

	window.orderlist = '<ul>';
	nodesChk(nodes,0,false);
	window.orderlist += '</ul>';

	//window.orderListTree = $("#demo_orderlist1").html(window.orderlist).easytree();
	window.orderListTree = $("#demo_orderlist1").html(window.orderlist);

}

function numToStr(thread_num){
	var my_thread_info = '';
	if((thread_num >= 100) && (thread_num < 1000)) {
		my_thread_info = "0" + thread_num;
	} else if((thread_num >= 10) && (thread_num < 100)) {
		my_thread_info = "00" + thread_num;
	} else if (thread_num < 10) {
		my_thread_info = "000" + thread_num;
	} else {
		my_thread_info = thread_num;
	}
	return my_thread_info;
}

function nodesChk(nodes,depth,active){

	var str;
	var i = 0;
	for (i = 0; i < nodes.length; i++) {


		if(window.activeId == nodes[i].href){
			trace('------------------------------------------');
			trace('click_text=>'+nodes[i].text);
			window.selectedTxt = nodes[i].text;

			trace('click_id=>'+nodes[i].href);
			window.selectedId = nodes[i].href;

			trace('click_depth=>'+depth);
			window._depth = depth + 1;

			trace('------------------------------------------');

			str = nodes[i].href;
			window.orderlist += '<li data-id='+str.substring(1, str.length)+' data-depth='+depth+'>' + nodes[i].text + ' (' + str.substring(1, str.length) + ')';

			active = true;

		}

		if(active){

			if (nodes[i].children && nodes[i].children.length > 0) {

				window.orderlist += '<ul>';
				nodesChkChildren(nodes[i].children,depth+1);
				window.orderlist += '</ul>';
				window.orderlist += '</li>';

			}

			break;

		}else{

			if(window._depth){
				if(window._depth < depth) break;
			}
			trace(window._depth + ' < ' + depth);

			if (nodes[i].children && nodes[i].children.length > 0) {

				nodesChk(nodes[i].children,depth+1,active);

			}

		}

	}

}


function nodesChkChildren(nodes,depth){

	var str;
	var i = 0;
	for (i = 0; i < nodes.length; i++) {

		str = nodes[i].href;
		window.orderlist += '<li style="cursor:pointer"><span class="launch_catview" data_id='+str.substring(1, str.length)+' data_depth='+depth+'>' + nodes[i].text + '</span> (' + str.substring(1, str.length) + ')';
		window.orderlist += ' selected </li>';

	}

}



(function($){$(document).ready(function(){

window._nodes;
window.urlParams = {};

var urlParamsChk = function(){
	var e,
		a = /\+/g,
		r = /([^&=]+)=?([^&]*)/g,
		d = function (s) { return decodeURIComponent(s.replace(a, " ")); },
		q = window.location.search.substring(1);
	while (e = r.exec(q))
		window.urlParams[d(e[1])] = d(e[2]);
};


var onLoad = function(uid) {
	$.ajax({
		url: '/data/getCategory.php',
		dataType: 'json',
		data : {
		},
		success: function(data){
			if(data!==null){
				window._nodes = data;
				stateChanged(data,uid);
			}
		},
		complete: function(){
			//trace('complete');
		},
		error: function(data){
			trace('error');
		}
	});
};

var listener = function() {
	$(document).on('click', 'span.launch_catview', function(e){// live() 같다
		var uid = $(this).attr('data_id');
		stateChanged(window._nodes,uid);
	});
};

var init = function() {
	onLoad('2014122322335838452');
	listener();

	History.pushState(null, null, "?dp1=2014122322423409017&dp2=2014122323007771124");
	urlParamsChk();
	trace("depth2 확인 : " + window.urlParams['dp2']);

};

init();


});})(jQuery);
</script>

<!-- [e] Article -->

